라우터

패킷의 IP를 분석하여 최적의 경로(다음라우터)를 L2로 붙임

--------------------------------------------------------------

홈 라우터 (공유기)

공유기는 사설IP를 쓰기위한 목적이다.
공유기는 IP의 적절한 분배, 분리, 방향을 결정하는것에 더해 유동IP를 배정해주는 일까지 한다. (DHCP내부장착)

공유기는 L2, L3, L4가 모두 뒤섞인 형태이다.

포트여러개		(L2기능)
라우터자체 기능		(L3의 기능존재)


(NAT : IP 패킷의 TCP/UDP 포트 숫자와 소스 및 목적지의 IP 주소 등을 재기록하면서 라우터를 통해 네트워크 트래픽을 주고 받는 기술)

--------------------------------------------------------------

MAC (Media Access Control Address) - L2계층

랜카드 등 다양한 네트워크 장비에 부여된주소
전세계에서 유일한 하나의 주소이다.
맥은 이더넷카드(랜카드) 그 자체를 의미한다.

MAC헤더에는 최종목적지(IP)가 아닌 다음목적지가 들어간다.

MAC의 첫번째는 라우터이며, 다음장비를 찾아간다.
--------------------------------------------------------------

공유기가 이러한 맥을 바꿔버리는 이유

통신사가 맥을 차단하기때문
규칙상 맥을 바꾸는 행위는 허용되지 않아야 하지만 별 문제 없으므로 통용된다.

--------------------------------------------------------------

MAC주소 - 물리주소 (고유)
IP주소	- 논리주소 (내가 바꾸면 바뀐다)

--------------------------------------------------------------

ISP(Internet service provider)

인터넷 통신사를 얘기한다.

--------------------------------------------------------------

CP(Content Provider) 네이버, 다음, 카카오같은 컨텐츠 서비스

--------------------------------------------------------------

포트

USHORT 로 포트번호가 매겨지므로 범위는 0~65535

--------------------------------------------------------------

IP 

배정된 개념이 아니라 구매를 하는 개념.
거의 대부분 회사들이 DB를 가져다 사용하므로 국가에 대한 차단가능

--------------------------------------------------------------

방화벽

소프트웨어로서 서버에서 작동할수도있고,
물리하드웨어에 배치하기도 한다. 
(돈이 없으면 소프트웨어)

--------------------------------------------------------------

백도어

일반적인 인증을 통과, 원격 접속을 보장하고 평문접근하여 정보를 취득하는 행위를 들키지않고 행하는 방법

--------------------------------------------------------------

랜섬웨어

svn프로토콜의 버그를 활용하여, 공유하지도 않은 파일에 자동으로 파일이 삽입되게끔 공격

--------------------------------------------------------------

IDC센터 (서버호텔)

서버 컴퓨터와 네트워크 회선등을 제공하는 건물이나 시설
IDC기업임에도 IDC센터에서 일정구역을 임대하여 다시 소규모로
판매하는 경우가 있다.

--------------------------------------------------------------

DDOS(디도스공격)

차단한다고 해도 트래픽이 들어오는 점을 이용한 UDP 공격
대역폭을 모두 사용하므로 IDC센터에도 피해가 간다.
대략 몇만대 이상의 좀비 PC로 공격한다.

--------------------------------------------------------------

프록시 서버

인터넷이 느린 예전에는 일종의 캐시서버로 사용했으나,
지금은 내 IP를 감추기위한 경유지로 사용한다.

--------------------------------------------------------------

Whois조회로 ip를 추적할 수 있다.

--------------------------------------------------------------

단위

1Gb(기가 비트)  = 125000000비트 전송속도
1GB(기가바이트) =  10억byte의 정보단위

--------------------------------------------------------------

OSI 7계층

7. Application Layer
6. Presentation Layer
5. Session Layer
4. Transport Layerpah
3. NetWork Layer
2. DataLink Layer
1. Physical Layer



5-6-7	Application
4	Transport
3	Internet
1-2 	NetWork Interface
--------------------------------------------------------------

하나의 패킷을 어떻게 부르는가?

L2 - 프레임
L3 - 패킷
L4 - 세그먼트
L7 - 메시지

--------------------------------------------------------------

계층마다 어떤 장치가 존재하는가?

L1 - 리피터 허브
L2 - 랜카드, 와이파이, 스위칭허브 
L3 - 라우터

--------------------------------------------------------------

L2 - 맥 어드레스 - 다음목적지(라우터)
L3 - IP주소
L4 - 포트번호

--------------------------------------------------------------

DHCP(Dynamic Host Configuration Protocol)서버

네트워크 안에 컴퓨터안에 자동으로 네임서버, IP주소, 게이트웨이 주소 등을 할당해주는것을 의미한다.

클라이언트에게 일정 기간 임대를 하는 동적 주소 할당 프로토콜

호스트 번호를 제외한 나머지값이 일치한다면 

IP주소, 게이트웨이, 서브넷마스크가 있어야만 
IP라는 주소체계에서 통신이 가능하다.

--------------------------------------------------------------

서브넷마스크란?

내 대역을 판단하는 역할을 함

--------------------------------------------------------------



호스트번호를 제외한 나머지값이 일치한다면
나와같은 서브넷 네트워크에 존재.
내가찾아가면 된다.

다른값이 나온경우는 게이트웨이로 전달.
(게이트웨이 = 다음라우터)

--------------------------------------------------------------

호스트번호 
0 = 해당네트워크 자체
255 = 브로드캐스팅

--------------------------------------------------------------


ARP프로토콜이란?

MAC Address를 찾아낼수있는 프로토콜로,
서브넷마스크를 이용하여 게이트웨이로 갈지
내 대역폭에서 다이렉트로 갈지 판단한다음
판단된 MAC주소를 알아낸다.


--------------------------------------------------------------


매트릭
라우터 메트릭은 라우터가 대상에 대한
실행 가능한 경로 중에서 최상의 경로를 선택한다.

메트릭이 가장낮은곳으로 이동한다.


--------------------------------------------------------------


메트릭을 조정할 상황

랜카드를 여러개 꽂다보면 드물게 사설네트워크로 
들어와야할 패킷이 게이트웨이로 나가버리는 경우가있다.
이떄 메트릭을 수동으로 조절해야한다.

--------------------------------------------------------------

ICMP란?

TCP/IP에서 IP패킷을 처리할때 발생되는 문제를
알려주는 프로토콜이다.
원칙상 TTL로 폐기시킨 패킷이 있을경우, 송신자
한테 ICMP로 응답하게 되어있다.

--------------------------------------------------------------

ping 명령어

ICMP를 이용한 것으로, 네트워크 세팅시 
최소한의 연결을 확인할때 주로 사용한다.

--------------------------------------------------------------

Tracert 명령어

TTL을 1로 설정하여 ping하는것으로,
첫번째 라우터에서 폐기하게끔 하여 ICMP응답을 
받아오는 명령어이다.

이후 목적지 IP에 도달할때까지 TTL값을 ++하여 정보를 얻어온다.
쉽게말하면 경로 추적툴이다.

--------------------------------------------------------------

UPnP

공유기의 포트맵핑 테이블이 불편하기때문에 나온 프로토콜.
공유기의 포트맵핑은 임의로 지정할수있는 형식이 아니므로
공유기한테 데이터를 쏴서 포트맵핑 테이블을 만들라고 할수있게끔 만든
프로토콜이 UPnP이다.

토렌토가 이방식을 택한다..
토렌토를 사용하는경우 외부에서 내집으로 들어올 방법이 없던것을 
강제로 열어버린다.

프로토콜이 XML양식대로 만들어져 공유기에게 던지면 포트테이블을
스태틱으로 만드는 형식이다.


--------------------------------------------------------------

하마치 (VPN)

하마치는 VPN으로, VPN프로그램이 VPN으로 연결을 하고 외부에서VPN으로 접속.
실제 컴퓨터가 VPN대역, 해당IP가 아닌데 VPN서버에 연결하면 이 IP가 내것인것처럼
작동하게된다.
하마치 접속해서 로그인하면 공인IP가 나오고, 이것을 다른쪽에 접속하라고 알려주는것.

--------------------------------------------------------------

Domain
도메인은 IP가 변경될수있는 환경에서 IP를 바꿔야하는겨우 사용.

--------------------------------------------------------------

NslookUp
해당명령어는 내가지금 사용하는 DNS서버한테 직접적으로 물어보는것이다.
ping역시 NDS서버에 조회하여 그 결과를 받은것.

--------------------------------------------------------------

도메인 - TTL
모든사용자가 도메인을 조회할때마다 DNS로 들어온다면 부담이 커진다.
따라서 DNS서버에 내가 지정한 IP를 얼마만큼 보관하는지(캐시) 시간을 지정
할수있는데, 이를 TTL이라고 한다.

--------------------------------------------------------------

DDNS
실시간으로 DNS를 갱신하는 방식으로, 주로 도메인의 IP가 유동적인 경우 사용된다. IP가 바뀌어도 ddns로 설정한 도메인값은 변하지않기 때문에 접속이가능한원리.

공유기에서 기본으로 제공되는 기능이다.
TTL값을 초단위로 설정하여 DNS업체측 서버로 사용자의 IP를 주기적으로 쏜다.

--------------------------------------------------------------


L4의 로드밸런서

서버가 사용자들을 감당하지못해서 서버를 늘렸을때 서버의 구분을 로드밸런서로 한다.
이는 어떤서버로 가도 똑같은 웹환경에서 가능하며, stateful구조의 경우
우리가 지정한 서버로 가야하기때문에 이와같은 구조는 불가능하다.

--------------------------------------------------------------

DNS의 로드밸런서

L4의 로드밸런스로도 감당되지않는경우, 도메인차원에서 로드밸런싱을 시도한다.
Domain에 IP를 여러 개 입력해두면 이중에 골라가는것으로, IP의 개수는 상관없다.

GetAddrInfo()

GetAddrIno로 도메인을 조회하면 IP가 리스트로 들어오는데, 
첫번째 노드만 사용하더라도 라운드로빈으로 돌아간다.



ipconfig

Ipconfig에서 제공되는 IP는 공유기의 공인IP가 아닌 컴퓨터의 이더넷이 셋팅된 IP를 주는것이다.




ipconfig/renew

Ipconfig에서 제공되는 IP는 공유기의 공인IP가 아닌 컴퓨터의 이더넷이 셋팅된 IP를 주는것이다.
DHCP클라이언트 컴퓨터로 구성된 컴퓨터에서만 사용이 가능하고, 서버로부터 새로운 IP주소 및 구성값을 받아오기 위해 사용한다.


ipconfig/displaydns

내 컴퓨터에 DNS에 대한 캐쉬정보를 보여준다.



ipconfig/flushdns

이때 캐시에 등록된 주소는 바뀌지않는데, 해당명령어는 기존 캐시를 초기화해준다.
(다시 ping으로 조회하면 다른 ip가 나올 것.)
소켓API 함수를 사용할때는 여러 개의 IP를 가져다가 우리가 골라서 쓰는 것이므로 사실 상 DNS캐쉬에 영향을 받는 일은 없음.


--------------------------------------------------------------

Socket API

제대로 성능을 내려면 오버랩I/O, IOCP등을 사용해야 하므로 윈속을 사용해야 한다.

--------------------------------------------------------------

